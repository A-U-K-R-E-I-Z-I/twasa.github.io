<!DOCTYPE html>
<html lang="en-us">

<head>
<meta charset="utf-8" />
<meta name="author" content="" />
<meta name="description" content="William&#39;s blog." />
<meta name="keywords" content="blog, tech" />
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.26" />

<link rel="canonical" href="https://twasa.github.io/post/lnmp/">
<base href="https://twasa.github.io/" />
<meta property="og:title" content="CentOS7 Linux Nginx MariaDB PHP" />
<meta property="og:description" content="Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm yum install nginx php php-fpm mariadb mariadb-server  firewalld for http, https access only firewall-cmd --zone=public --list-all firewall-cmd --permanent --zone=public --add-service=http firewall-cmd --permanent --zone=public --add-service=https firewall-cmd --reload firewall-cmd --zone=public --list-all  Nginx config basic config, edit /etc/nginx/nginx.conf user nginx; worker_processes 2; #by your cpu error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://twasa.github.io/post/lnmp/" />



<meta property="article:published_time" content="2017-09-11T10:14:51&#43;08:00"/>
<meta property="article:modified_time" content="2017-09-11T10:14:51&#43;08:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="CentOS7 Linux Nginx MariaDB PHP"/>
<meta name="twitter:description" content="Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm yum install nginx php php-fpm mariadb mariadb-server  firewalld for http, https access only firewall-cmd --zone=public --list-all firewall-cmd --permanent --zone=public --add-service=http firewall-cmd --permanent --zone=public --add-service=https firewall-cmd --reload firewall-cmd --zone=public --list-all  Nginx config basic config, edit /etc/nginx/nginx.conf user nginx; worker_processes 2; #by your cpu error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime."/>



<meta itemprop="name" content="CentOS7 Linux Nginx MariaDB PHP">
<meta itemprop="description" content="Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm yum install nginx php php-fpm mariadb mariadb-server  firewalld for http, https access only firewall-cmd --zone=public --list-all firewall-cmd --permanent --zone=public --add-service=http firewall-cmd --permanent --zone=public --add-service=https firewall-cmd --reload firewall-cmd --zone=public --list-all  Nginx config basic config, edit /etc/nginx/nginx.conf user nginx; worker_processes 2; #by your cpu error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime.">


<meta itemprop="dateModified" content="2017-09-11T10:14:51&#43;08:00" />
<meta itemprop="wordCount" content="230">



<meta itemprop="keywords" content="Linux,Webserver," />


<link rel="stylesheet" href="css/layout.css" />
<link rel="stylesheet" href="css/color-dark.css" />



<title>


     CentOS7 Linux Nginx MariaDB PHP 

</title>

<script src="js/highlight.min.js"></script>
<link rel="stylesheet" href="css/tomorrow-night.min.css" />
<script>hljs.initHighlightingOnLoad();</script>

</head>


<body>
<div class="main">
<header>

<div class="header-bar">

  <nav>
    <div class="siteTitle">
      <a href="https://twasa.github.io/">William&#39;s Blog</a>
    </div> 

    
    
    <a class="nav-item" href="https://twasa.github.io/post/"><div class="nav-item-title">Posts</div></a>
    
    <a class="nav-item" href="https://twasa.github.io/about/"><div class="nav-item-title">About Hugo</div></a>
    
    <a class="nav-item" href="https://twasa.github.io/tags/"><div class="nav-item-title">Tags</div></a>
    

  </nav>
</div>

  
<div class="social-links-header">

  

  
  <a href="https://github.com/twasa" target="_blank"><div class="social-link">GitHub</div></a>
  

  

  

  

</div>


</header>


<article class="post">
    <h1 class="title"> CentOS7 Linux Nginx MariaDB PHP </h1>
    <div class="content"> 

<h1 id="build-a-linux-nginx-mariadb-php-environment-in-centos-7">Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7</h1>

<h2 id="install">install</h2>

<pre><code>rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
yum install nginx php php-fpm mariadb mariadb-server
</code></pre>

<h2 id="firewalld-for-http-https-access-only">firewalld for http, https access only</h2>

<pre><code>firewall-cmd --zone=public --list-all
firewall-cmd --permanent --zone=public --add-service=http
firewall-cmd --permanent --zone=public --add-service=https
firewall-cmd --reload
firewall-cmd --zone=public --list-all
</code></pre>

<h2 id="nginx-config">Nginx config</h2>

<h3 id="basic-config-edit-etc-nginx-nginx-conf">basic config, edit /etc/nginx/nginx.conf</h3>

<pre><code>user  nginx;
worker_processes  2; #by your cpu

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024; 
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
                      '$status $body_bytes_sent &quot;$http_referer&quot; '
                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;
    server_tokens   off;
    keepalive_timeout  65;

    gzip  on;
    include /etc/nginx/conf.d/*.conf;
}
</code></pre>

<h3 id="config-for-pass-the-php-scripts-to-fastcgi-server-php-fpm-using-file-socket-in-etc-nginx-conf-d-default-conf">config for pass the PHP scripts to FastCGI server php-fpm using file socket in /etc/nginx/conf.d/default.conf</h3>

<pre><code>server {
    listen       80;
    server_name  localhost;

    #charset koi8-r;
    access_log  /var/log/nginx/host.access.log  main;
    root   /usr/share/nginx/html;
    index  index.html index.php index.htm;

    location / {

    }

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    location ~ \.php$ {
        fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        include        fastcgi_params;
    }

# session path
# for mod_php, see /etc/httpd/conf.d/php.conf
# for php-fpm, see /etc/php-fpm.d/*conf
</code></pre>

<h2 id="php-config-in-etc-php-ini">PHP config in /etc/php.ini</h2>

<pre><code>cgi.fix_pathinfo=0
</code></pre>

<h2 id="php-fpm-config-in-etc-php-fpm-d-www-conf">PHP-FPM config in /etc/php-fpm.d/www.conf</h2>

<p>listen = /var/run/php-fpm/php-fpm.sock
listen.owner = nobody
listen.group = nobody
listen.mode = 0666
user = nginx
group = nginx</p>

<h2 id="mariadb-config">MariaDB config</h2>

<p>reference to <a href="https://twasa.github.io/post/my-db/">https://twasa.github.io/post/my-db/</a></p>

<h2 id="verify">Verify</h2>

<h3 id="create-usr-share-nginx-html-info-php">create /usr/share/nginx/html/info.php</h3>

<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>

<h2 id="web-permission-for-nginx">web permission for nginx</h2>

<pre><code>chown -R nginx:nginx /usr/share/nginx/html/
</code></pre>

<h2 id="selinux">selinux</h2>

<pre><code>chcon --reference=/usr/share/nginx/html/index.html /usr/share/nginx/html/*
</code></pre>

<h3 id="visit-http-server-info-php-to-verify">visit <a href="http://server/info.php">http://server/info.php</a> to Verify</h3>
 </div>
    <footer class="post-footer">

  <div class="post-footer-data">
    
<div class="tags">
    
      <div class="tag">
        <a href="https://twasa.github.io/tags/linux">#Linux</a>
      </div>
    
      <div class="tag">
        <a href="https://twasa.github.io/tags/webserver">#Webserver</a>
      </div>
    
</div>

    <div class="date"> Sep 11, 2017 </div>
  </div>

</footer>


  



</article>

  <footer>

  <div class="social-links-footer">

  

  
  <a href="https://github.com/twasa" target="_blank"><div class="social-link">GitHub</div></a>
  

  

  

  

  <div class="social-link">
  <a href="https://twasa.github.io/index.xml" target="_blank">RSS</a>
  </div>

</div>


  <div class="copyright"> Copyright (c) 2017, all rights reserved. </div>

  <div class="poweredby">
    Powered by <a href="https://gohugo.io/">Hugo</a>.
  </div>

  </footer>

</body>
</html>

